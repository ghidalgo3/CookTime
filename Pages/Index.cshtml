@page
@model babe_algorithms.Pages.Recipes.IndexModel
@{
    ViewData["Title"] = "Index";
    Layout = "_Layout";
}

<div class="row" style="display: flex; align-items: center; justify-content: center;">
        <div class="col-10">
            <h1 class="margin-bottom-20">Recipes</h1>
        </div>
        <div class="margin-bottom-20 col-2 text-end"> 
            <a asp-page="./Recipes/Create"><i class="fas fa-plus-circle themePrimary-color fa-2x"></i></a>
        </div>
</div>

<div class="row">
    @foreach (var item in Model.Recipes) {
        var cats = string.Join(", ", item.Categories);
        if (string.IsNullOrEmpty(cats))
        {
            cats = "Recipe";
        }
        <div class="col-sm-4">
            <a asp-page="./Recipes/Details" asp-route-id="@item.Id">
                <div data-average-reviews="@item.AverageReviews" data-review-count="@item.ReviewCount" class="card margin-bottom-20 recipe-card">
                    @{
                        var image = (item.ImageIds.Count == 0) ? "/placeholder.jpg" : $"/image/{item.ImageIds.FirstOrDefault()}?width=300";
                        <img class="card-img-top card-recipe-image" src="@image" alt="Food image">
                    }
                    <div class="card-body ">
                        <p class="tag-style do-not-overflow-text margin-bottom-0">@cats</p>
                        <h5 class="margin-bottom-0 card-title do-not-overflow-text">@Html.DisplayFor(modelItem => item.Name)</h5>
                        @if (item.ReviewCount > 0)
                        {
                            <div id="rating-target"></div>
                        @* <p>Average reviews: @item.AverageReviews</p>
                        <p>Total reviews: @item.ReviewCount</p> *@
                        }
                        @* <input value="@item.Id" type="hidden" name="recipeId"/> *@
                        @* <button
                            data-bs-toggle="tooltip" 
                            data-bs-placement="right" 
                            title="Add recipe to grocery list"
                            type="submit"
                            asp-page-handler="AddToCart"
                            class="btn btn-primary troubled-water-color width-100">Add to groceries</button> *@
                    </div>
                </div>
            </a>
        </div>
    }
</div>

<script type="text/javascript" src="~/js/cardReviewDisplay.js" asp-append-version="true"></script>