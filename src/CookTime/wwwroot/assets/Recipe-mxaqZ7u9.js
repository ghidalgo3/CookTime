import{r as x,j as s,w as rr,u as nr}from"./chunk-EPOLDU6W-43oXRp_d.js";import{h as ir,u as sr,a as at,D as ar,c as or,S as lr,v as cr,b as ur,s as dr,K as pr,P as fr,d as hr,C as mr,A as gr,N as vr,I as xr}from"./NutritionFacts-BZrWORPh.js";import{M as We}from"./index-MnCcLIiK.js";import{d as wr,e as Fe,b as yr,c as ot,r as br,h as lt,a as jr}from"./hasClass-CMLzWJ9n.js";import{P as Cr}from"./browser-DefK9-wN.js";import{w as Sr,F as k,a as Or}from"./Form-DuBjGd-t.js";import{o as Pt,l as pe,j as Rr,d as Et,a as Nr,F as ct,k as $e,g as Pr,m as Er}from"./CloseButton-XSD3H_yA.js";import{u as ie,c as xe,e as Dt}from"./ThemeProvider-CkrZYoIe.js";import{R as Dr}from"./index-Bq9MN8hm.js";import{u as Le}from"./useEventCallback-MTpNBJAZ.js";import{C as j,B as I,R as T}from"./Row-Ce-ZerzP.js";import{j as Tr,k as Ar}from"./CookTime.service-DGqb8wqN.js";import{u as Mr,a as ut}from"./AuthenticationContext-B1R-ZdmL.js";import{C as Ie}from"./Card-YjBlU5Fj.js";import{v as ne,T as kr}from"./todaysTenDisplay-BIIdUU_S.js";import{S as Ir}from"./Spinner-Bc6SJCTR.js";import{S as Fr}from"./Stack-CK4X97tz.js";import{A as dt}from"./Alert-R-VQZ3Me.js";import{W as $r}from"./index.module-DKd-uFxg.js";function Lr(t){return{id:t.id,name:t.name,ownerId:t.owner?.id??"",prepMinutes:null,cookingMinutes:t.cooktimeMinutes??null,servings:t.servingsProduced??null,calories:t.caloriesPerServing??null,description:null,source:t.source??null,components:t.recipeComponents.map((e,r)=>({name:e.name??null,position:e.position??r,steps:(e.steps??[]).filter(n=>n!=null&&n.trim()!==""),ingredients:(e.ingredients??[]).filter(n=>n.ingredient?.id).map((n,i)=>({ingredientId:n.ingredient.id,quantity:n.quantity??0,unit:n.unit??null,position:n.position??i,description:n.text??null}))})),categoryIds:t.categories.filter(e=>e?.id!=null).map(e=>e.id)}}function pt(){return x.useState(null)}function Br(){const t=x.useRef(!0),e=x.useRef(()=>t.current);return x.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]),e.current}function qr(t){const e=x.useRef(t);return e.current=t,e}function Ur(t){const e=qr(t);x.useEffect(()=>()=>e.current(),[])}const Be=2**31-1;function Tt(t,e,r){const n=r-Date.now();t.current=n<=Be?setTimeout(e,n):setTimeout(()=>Tt(t,e,r),Be)}function Wr(){const t=Br(),e=x.useRef();return Ur(()=>clearTimeout(e.current)),x.useMemo(()=>{const r=()=>clearTimeout(e.current);function n(i,a=0){t()&&(r(),a<=Be?e.current=setTimeout(i,a):Tt(e,i,Date.now()+a))}return{set:n,clear:r,handleRef:e}},[])}var ft=Object.prototype.hasOwnProperty;function ht(t,e,r){for(r of t.keys())if(fe(r,e))return r}function fe(t,e){var r,n,i;if(t===e)return!0;if(t&&e&&(r=t.constructor)===e.constructor){if(r===Date)return t.getTime()===e.getTime();if(r===RegExp)return t.toString()===e.toString();if(r===Array){if((n=t.length)===e.length)for(;n--&&fe(t[n],e[n]););return n===-1}if(r===Set){if(t.size!==e.size)return!1;for(n of t)if(i=n,i&&typeof i=="object"&&(i=ht(e,i),!i)||!e.has(i))return!1;return!0}if(r===Map){if(t.size!==e.size)return!1;for(n of t)if(i=n[0],i&&typeof i=="object"&&(i=ht(e,i),!i)||!fe(n[1],e.get(i)))return!1;return!0}if(r===ArrayBuffer)t=new Uint8Array(t),e=new Uint8Array(e);else if(r===DataView){if((n=t.byteLength)===e.byteLength)for(;n--&&t.getInt8(n)===e.getInt8(n););return n===-1}if(ArrayBuffer.isView(t)){if((n=t.byteLength)===e.byteLength)for(;n--&&t[n]===e[n];);return n===-1}if(!r||typeof t=="object"){n=0;for(r in t)if(ft.call(t,r)&&++n&&!ft.call(e,r)||!(r in e)||!fe(t[r],e[r]))return!1;return Object.keys(e).length===n}}return t!==t&&e!==e}function Hr(t){const e=wr();return[t[0],x.useCallback(r=>{if(e())return t[1](r)},[e,t[1]])]}var $="top",W="bottom",H="right",L="left",He="auto",we=[$,W,H,L],se="start",ge="end",_r="clippingParents",At="viewport",de="popper",Vr="reference",mt=we.reduce(function(t,e){return t.concat([e+"-"+se,e+"-"+ge])},[]),Mt=[].concat(we,[He]).reduce(function(t,e){return t.concat([e,e+"-"+se,e+"-"+ge])},[]),zr="beforeRead",Kr="read",Yr="afterRead",Xr="beforeMain",Gr="main",Qr="afterMain",Jr="beforeWrite",Zr="write",en="afterWrite",tn=[zr,Kr,Yr,Xr,Gr,Qr,Jr,Zr,en];function V(t){return t.split("-")[0]}function U(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function te(t){var e=U(t).Element;return t instanceof e||t instanceof Element}function z(t){var e=U(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function _e(t){if(typeof ShadowRoot>"u")return!1;var e=U(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}var ee=Math.max,Ee=Math.min,ae=Math.round;function qe(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function kt(){return!/^((?!chrome|android).)*safari/i.test(qe())}function oe(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var n=t.getBoundingClientRect(),i=1,a=1;e&&z(t)&&(i=t.offsetWidth>0&&ae(n.width)/t.offsetWidth||1,a=t.offsetHeight>0&&ae(n.height)/t.offsetHeight||1);var l=te(t)?U(t):window,c=l.visualViewport,o=!kt()&&r,d=(n.left+(o&&c?c.offsetLeft:0))/i,u=(n.top+(o&&c?c.offsetTop:0))/a,h=n.width/i,v=n.height/a;return{width:h,height:v,top:u,right:d+h,bottom:u+v,left:d,x:d,y:u}}function Ve(t){var e=oe(t),r=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:n}}function It(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&_e(r)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function X(t){return t?(t.nodeName||"").toLowerCase():null}function K(t){return U(t).getComputedStyle(t)}function rn(t){return["table","td","th"].indexOf(X(t))>=0}function G(t){return((te(t)?t.ownerDocument:t.document)||window.document).documentElement}function De(t){return X(t)==="html"?t:t.assignedSlot||t.parentNode||(_e(t)?t.host:null)||G(t)}function gt(t){return!z(t)||K(t).position==="fixed"?null:t.offsetParent}function nn(t){var e=/firefox/i.test(qe()),r=/Trident/i.test(qe());if(r&&z(t)){var n=K(t);if(n.position==="fixed")return null}var i=De(t);for(_e(i)&&(i=i.host);z(i)&&["html","body"].indexOf(X(i))<0;){var a=K(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function ye(t){for(var e=U(t),r=gt(t);r&&rn(r)&&K(r).position==="static";)r=gt(r);return r&&(X(r)==="html"||X(r)==="body"&&K(r).position==="static")?e:r||nn(t)||e}function ze(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function he(t,e,r){return ee(t,Ee(e,r))}function sn(t,e,r){var n=he(t,e,r);return n>r?r:n}function Ft(){return{top:0,right:0,bottom:0,left:0}}function $t(t){return Object.assign({},Ft(),t)}function Lt(t,e){return e.reduce(function(r,n){return r[n]=t,r},{})}var an=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,$t(typeof e!="number"?e:Lt(e,we))};function on(t){var e,r=t.state,n=t.name,i=t.options,a=r.elements.arrow,l=r.modifiersData.popperOffsets,c=V(r.placement),o=ze(c),d=[L,H].indexOf(c)>=0,u=d?"height":"width";if(!(!a||!l)){var h=an(i.padding,r),v=Ve(a),f=o==="y"?$:L,m=o==="y"?W:H,g=r.rects.reference[u]+r.rects.reference[o]-l[o]-r.rects.popper[u],p=l[o]-r.rects.reference[o],w=ye(a),y=w?o==="y"?w.clientHeight||0:w.clientWidth||0:0,C=g/2-p/2,b=h[f],O=y-v[u]-h[m],S=y/2-v[u]/2+C,R=he(b,S,O),E=o;r.modifiersData[n]=(e={},e[E]=R,e.centerOffset=R-S,e)}}function ln(t){var e=t.state,r=t.options,n=r.element,i=n===void 0?"[data-popper-arrow]":n;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||It(e.elements.popper,i)&&(e.elements.arrow=i))}const cn={name:"arrow",enabled:!0,phase:"main",fn:on,effect:ln,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function le(t){return t.split("-")[1]}var un={top:"auto",right:"auto",bottom:"auto",left:"auto"};function dn(t,e){var r=t.x,n=t.y,i=e.devicePixelRatio||1;return{x:ae(r*i)/i||0,y:ae(n*i)/i||0}}function vt(t){var e,r=t.popper,n=t.popperRect,i=t.placement,a=t.variation,l=t.offsets,c=t.position,o=t.gpuAcceleration,d=t.adaptive,u=t.roundOffsets,h=t.isFixed,v=l.x,f=v===void 0?0:v,m=l.y,g=m===void 0?0:m,p=typeof u=="function"?u({x:f,y:g}):{x:f,y:g};f=p.x,g=p.y;var w=l.hasOwnProperty("x"),y=l.hasOwnProperty("y"),C=L,b=$,O=window;if(d){var S=ye(r),R="clientHeight",E="clientWidth";if(S===U(r)&&(S=G(r),K(S).position!=="static"&&c==="absolute"&&(R="scrollHeight",E="scrollWidth")),S=S,i===$||(i===L||i===H)&&a===ge){b=W;var P=h&&S===O&&O.visualViewport?O.visualViewport.height:S[R];g-=P-n.height,g*=o?1:-1}if(i===L||(i===$||i===W)&&a===ge){C=H;var N=h&&S===O&&O.visualViewport?O.visualViewport.width:S[E];f-=N-n.width,f*=o?1:-1}}var D=Object.assign({position:c},d&&un),B=u===!0?dn({x:f,y:g},U(r)):{x:f,y:g};if(f=B.x,g=B.y,o){var A;return Object.assign({},D,(A={},A[b]=y?"0":"",A[C]=w?"0":"",A.transform=(O.devicePixelRatio||1)<=1?"translate("+f+"px, "+g+"px)":"translate3d("+f+"px, "+g+"px, 0)",A))}return Object.assign({},D,(e={},e[b]=y?g+"px":"",e[C]=w?f+"px":"",e.transform="",e))}function pn(t){var e=t.state,r=t.options,n=r.gpuAcceleration,i=n===void 0?!0:n,a=r.adaptive,l=a===void 0?!0:a,c=r.roundOffsets,o=c===void 0?!0:c,d={placement:V(e.placement),variation:le(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,vt(Object.assign({},d,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:l,roundOffsets:o})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,vt(Object.assign({},d,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:o})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const fn={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:pn,data:{}};var Re={passive:!0};function hn(t){var e=t.state,r=t.instance,n=t.options,i=n.scroll,a=i===void 0?!0:i,l=n.resize,c=l===void 0?!0:l,o=U(e.elements.popper),d=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&d.forEach(function(u){u.addEventListener("scroll",r.update,Re)}),c&&o.addEventListener("resize",r.update,Re),function(){a&&d.forEach(function(u){u.removeEventListener("scroll",r.update,Re)}),c&&o.removeEventListener("resize",r.update,Re)}}const mn={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:hn,data:{}};var gn={left:"right",right:"left",bottom:"top",top:"bottom"};function Ne(t){return t.replace(/left|right|bottom|top/g,function(e){return gn[e]})}var vn={start:"end",end:"start"};function xt(t){return t.replace(/start|end/g,function(e){return vn[e]})}function Ke(t){var e=U(t),r=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:r,scrollTop:n}}function Ye(t){return oe(G(t)).left+Ke(t).scrollLeft}function xn(t,e){var r=U(t),n=G(t),i=r.visualViewport,a=n.clientWidth,l=n.clientHeight,c=0,o=0;if(i){a=i.width,l=i.height;var d=kt();(d||!d&&e==="fixed")&&(c=i.offsetLeft,o=i.offsetTop)}return{width:a,height:l,x:c+Ye(t),y:o}}function wn(t){var e,r=G(t),n=Ke(t),i=(e=t.ownerDocument)==null?void 0:e.body,a=ee(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),l=ee(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),c=-n.scrollLeft+Ye(t),o=-n.scrollTop;return K(i||r).direction==="rtl"&&(c+=ee(r.clientWidth,i?i.clientWidth:0)-a),{width:a,height:l,x:c,y:o}}function Xe(t){var e=K(t),r=e.overflow,n=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function Bt(t){return["html","body","#document"].indexOf(X(t))>=0?t.ownerDocument.body:z(t)&&Xe(t)?t:Bt(De(t))}function me(t,e){var r;e===void 0&&(e=[]);var n=Bt(t),i=n===((r=t.ownerDocument)==null?void 0:r.body),a=U(n),l=i?[a].concat(a.visualViewport||[],Xe(n)?n:[]):n,c=e.concat(l);return i?c:c.concat(me(De(l)))}function Ue(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function yn(t,e){var r=oe(t,!1,e==="fixed");return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function wt(t,e,r){return e===At?Ue(xn(t,r)):te(e)?yn(e,r):Ue(wn(G(t)))}function bn(t){var e=me(De(t)),r=["absolute","fixed"].indexOf(K(t).position)>=0,n=r&&z(t)?ye(t):t;return te(n)?e.filter(function(i){return te(i)&&It(i,n)&&X(i)!=="body"}):[]}function jn(t,e,r,n){var i=e==="clippingParents"?bn(t):[].concat(e),a=[].concat(i,[r]),l=a[0],c=a.reduce(function(o,d){var u=wt(t,d,n);return o.top=ee(u.top,o.top),o.right=Ee(u.right,o.right),o.bottom=Ee(u.bottom,o.bottom),o.left=ee(u.left,o.left),o},wt(t,l,n));return c.width=c.right-c.left,c.height=c.bottom-c.top,c.x=c.left,c.y=c.top,c}function qt(t){var e=t.reference,r=t.element,n=t.placement,i=n?V(n):null,a=n?le(n):null,l=e.x+e.width/2-r.width/2,c=e.y+e.height/2-r.height/2,o;switch(i){case $:o={x:l,y:e.y-r.height};break;case W:o={x:l,y:e.y+e.height};break;case H:o={x:e.x+e.width,y:c};break;case L:o={x:e.x-r.width,y:c};break;default:o={x:e.x,y:e.y}}var d=i?ze(i):null;if(d!=null){var u=d==="y"?"height":"width";switch(a){case se:o[d]=o[d]-(e[u]/2-r[u]/2);break;case ge:o[d]=o[d]+(e[u]/2-r[u]/2);break}}return o}function ve(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=n===void 0?t.placement:n,a=r.strategy,l=a===void 0?t.strategy:a,c=r.boundary,o=c===void 0?_r:c,d=r.rootBoundary,u=d===void 0?At:d,h=r.elementContext,v=h===void 0?de:h,f=r.altBoundary,m=f===void 0?!1:f,g=r.padding,p=g===void 0?0:g,w=$t(typeof p!="number"?p:Lt(p,we)),y=v===de?Vr:de,C=t.rects.popper,b=t.elements[m?y:v],O=jn(te(b)?b:b.contextElement||G(t.elements.popper),o,u,l),S=oe(t.elements.reference),R=qt({reference:S,element:C,placement:i}),E=Ue(Object.assign({},C,R)),P=v===de?E:S,N={top:O.top-P.top+w.top,bottom:P.bottom-O.bottom+w.bottom,left:O.left-P.left+w.left,right:P.right-O.right+w.right},D=t.modifiersData.offset;if(v===de&&D){var B=D[i];Object.keys(N).forEach(function(A){var F=[H,W].indexOf(A)>=0?1:-1,M=[$,W].indexOf(A)>=0?"y":"x";N[A]+=B[M]*F})}return N}function Cn(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=r.boundary,a=r.rootBoundary,l=r.padding,c=r.flipVariations,o=r.allowedAutoPlacements,d=o===void 0?Mt:o,u=le(n),h=u?c?mt:mt.filter(function(m){return le(m)===u}):we,v=h.filter(function(m){return d.indexOf(m)>=0});v.length===0&&(v=h);var f=v.reduce(function(m,g){return m[g]=ve(t,{placement:g,boundary:i,rootBoundary:a,padding:l})[V(g)],m},{});return Object.keys(f).sort(function(m,g){return f[m]-f[g]})}function Sn(t){if(V(t)===He)return[];var e=Ne(t);return[xt(t),e,xt(e)]}function On(t){var e=t.state,r=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var i=r.mainAxis,a=i===void 0?!0:i,l=r.altAxis,c=l===void 0?!0:l,o=r.fallbackPlacements,d=r.padding,u=r.boundary,h=r.rootBoundary,v=r.altBoundary,f=r.flipVariations,m=f===void 0?!0:f,g=r.allowedAutoPlacements,p=e.options.placement,w=V(p),y=w===p,C=o||(y||!m?[Ne(p)]:Sn(p)),b=[p].concat(C).reduce(function(re,Y){return re.concat(V(Y)===He?Cn(e,{placement:Y,boundary:u,rootBoundary:h,padding:d,flipVariations:m,allowedAutoPlacements:g}):Y)},[]),O=e.rects.reference,S=e.rects.popper,R=new Map,E=!0,P=b[0],N=0;N<b.length;N++){var D=b[N],B=V(D),A=le(D)===se,F=[$,W].indexOf(B)>=0,M=F?"width":"height",q=ve(e,{placement:D,boundary:u,rootBoundary:h,altBoundary:v,padding:d}),_=F?A?H:L:A?W:$;O[M]>S[M]&&(_=Ne(_));var be=Ne(_),Q=[];if(a&&Q.push(q[B]<=0),c&&Q.push(q[_]<=0,q[be]<=0),Q.every(function(re){return re})){P=D,E=!1;break}R.set(D,Q)}if(E)for(var je=m?3:1,Te=function(Y){var ue=b.find(function(Se){var J=R.get(Se);if(J)return J.slice(0,Y).every(function(Ae){return Ae})});if(ue)return P=ue,"break"},ce=je;ce>0;ce--){var Ce=Te(ce);if(Ce==="break")break}e.placement!==P&&(e.modifiersData[n]._skip=!0,e.placement=P,e.reset=!0)}}const Rn={name:"flip",enabled:!0,phase:"main",fn:On,requiresIfExists:["offset"],data:{_skip:!1}};function yt(t,e,r){return r===void 0&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function bt(t){return[$,H,W,L].some(function(e){return t[e]>=0})}function Nn(t){var e=t.state,r=t.name,n=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,l=ve(e,{elementContext:"reference"}),c=ve(e,{altBoundary:!0}),o=yt(l,n),d=yt(c,i,a),u=bt(o),h=bt(d);e.modifiersData[r]={referenceClippingOffsets:o,popperEscapeOffsets:d,isReferenceHidden:u,hasPopperEscaped:h},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":h})}const Pn={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Nn};function En(t,e,r){var n=V(t),i=[L,$].indexOf(n)>=0?-1:1,a=typeof r=="function"?r(Object.assign({},e,{placement:t})):r,l=a[0],c=a[1];return l=l||0,c=(c||0)*i,[L,H].indexOf(n)>=0?{x:c,y:l}:{x:l,y:c}}function Dn(t){var e=t.state,r=t.options,n=t.name,i=r.offset,a=i===void 0?[0,0]:i,l=Mt.reduce(function(u,h){return u[h]=En(h,e.rects,a),u},{}),c=l[e.placement],o=c.x,d=c.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=o,e.modifiersData.popperOffsets.y+=d),e.modifiersData[n]=l}const Tn={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Dn};function An(t){var e=t.state,r=t.name;e.modifiersData[r]=qt({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Mn={name:"popperOffsets",enabled:!0,phase:"read",fn:An,data:{}};function kn(t){return t==="x"?"y":"x"}function In(t){var e=t.state,r=t.options,n=t.name,i=r.mainAxis,a=i===void 0?!0:i,l=r.altAxis,c=l===void 0?!1:l,o=r.boundary,d=r.rootBoundary,u=r.altBoundary,h=r.padding,v=r.tether,f=v===void 0?!0:v,m=r.tetherOffset,g=m===void 0?0:m,p=ve(e,{boundary:o,rootBoundary:d,padding:h,altBoundary:u}),w=V(e.placement),y=le(e.placement),C=!y,b=ze(w),O=kn(b),S=e.modifiersData.popperOffsets,R=e.rects.reference,E=e.rects.popper,P=typeof g=="function"?g(Object.assign({},e.rects,{placement:e.placement})):g,N=typeof P=="number"?{mainAxis:P,altAxis:P}:Object.assign({mainAxis:0,altAxis:0},P),D=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,B={x:0,y:0};if(S){if(a){var A,F=b==="y"?$:L,M=b==="y"?W:H,q=b==="y"?"height":"width",_=S[b],be=_+p[F],Q=_-p[M],je=f?-E[q]/2:0,Te=y===se?R[q]:E[q],ce=y===se?-E[q]:-R[q],Ce=e.elements.arrow,re=f&&Ce?Ve(Ce):{width:0,height:0},Y=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Ft(),ue=Y[F],Se=Y[M],J=he(0,R[q],re[q]),Ae=C?R[q]/2-je-J-ue-N.mainAxis:Te-J-ue-N.mainAxis,Gt=C?-R[q]/2+je+J+Se+N.mainAxis:ce+J+Se+N.mainAxis,Me=e.elements.arrow&&ye(e.elements.arrow),Qt=Me?b==="y"?Me.clientTop||0:Me.clientLeft||0:0,Qe=(A=D?.[b])!=null?A:0,Jt=_+Ae-Qe-Qt,Zt=_+Gt-Qe,Je=he(f?Ee(be,Jt):be,_,f?ee(Q,Zt):Q);S[b]=Je,B[b]=Je-_}if(c){var Ze,er=b==="x"?$:L,tr=b==="x"?W:H,Z=S[O],Oe=O==="y"?"height":"width",et=Z+p[er],tt=Z-p[tr],ke=[$,L].indexOf(w)!==-1,rt=(Ze=D?.[O])!=null?Ze:0,nt=ke?et:Z-R[Oe]-E[Oe]-rt+N.altAxis,it=ke?Z+R[Oe]+E[Oe]-rt-N.altAxis:tt,st=f&&ke?sn(nt,Z,it):he(f?nt:et,Z,f?it:tt);S[O]=st,B[O]=st-Z}e.modifiersData[n]=B}}const Fn={name:"preventOverflow",enabled:!0,phase:"main",fn:In,requiresIfExists:["offset"]};function $n(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Ln(t){return t===U(t)||!z(t)?Ke(t):$n(t)}function Bn(t){var e=t.getBoundingClientRect(),r=ae(e.width)/t.offsetWidth||1,n=ae(e.height)/t.offsetHeight||1;return r!==1||n!==1}function qn(t,e,r){r===void 0&&(r=!1);var n=z(e),i=z(e)&&Bn(e),a=G(e),l=oe(t,i,r),c={scrollLeft:0,scrollTop:0},o={x:0,y:0};return(n||!n&&!r)&&((X(e)!=="body"||Xe(a))&&(c=Ln(e)),z(e)?(o=oe(e,!0),o.x+=e.clientLeft,o.y+=e.clientTop):a&&(o.x=Ye(a))),{x:l.left+c.scrollLeft-o.x,y:l.top+c.scrollTop-o.y,width:l.width,height:l.height}}function Un(t){var e=new Map,r=new Set,n=[];t.forEach(function(a){e.set(a.name,a)});function i(a){r.add(a.name);var l=[].concat(a.requires||[],a.requiresIfExists||[]);l.forEach(function(c){if(!r.has(c)){var o=e.get(c);o&&i(o)}}),n.push(a)}return t.forEach(function(a){r.has(a.name)||i(a)}),n}function Wn(t){var e=Un(t);return tn.reduce(function(r,n){return r.concat(e.filter(function(i){return i.phase===n}))},[])}function Hn(t){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(t())})})),e}}function _n(t){var e=t.reduce(function(r,n){var i=r[n.name];return r[n.name]=i?Object.assign({},i,n,{options:Object.assign({},i.options,n.options),data:Object.assign({},i.data,n.data)}):n,r},{});return Object.keys(e).map(function(r){return e[r]})}var jt={placement:"bottom",modifiers:[],strategy:"absolute"};function Ct(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function Vn(t){t===void 0&&(t={});var e=t,r=e.defaultModifiers,n=r===void 0?[]:r,i=e.defaultOptions,a=i===void 0?jt:i;return function(c,o,d){d===void 0&&(d=a);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},jt,a),modifiersData:{},elements:{reference:c,popper:o},attributes:{},styles:{}},h=[],v=!1,f={state:u,setOptions:function(w){var y=typeof w=="function"?w(u.options):w;g(),u.options=Object.assign({},a,u.options,y),u.scrollParents={reference:te(c)?me(c):c.contextElement?me(c.contextElement):[],popper:me(o)};var C=Wn(_n([].concat(n,u.options.modifiers)));return u.orderedModifiers=C.filter(function(b){return b.enabled}),m(),f.update()},forceUpdate:function(){if(!v){var w=u.elements,y=w.reference,C=w.popper;if(Ct(y,C)){u.rects={reference:qn(y,ye(C),u.options.strategy==="fixed"),popper:Ve(C)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(N){return u.modifiersData[N.name]=Object.assign({},N.data)});for(var b=0;b<u.orderedModifiers.length;b++){if(u.reset===!0){u.reset=!1,b=-1;continue}var O=u.orderedModifiers[b],S=O.fn,R=O.options,E=R===void 0?{}:R,P=O.name;typeof S=="function"&&(u=S({state:u,options:E,name:P,instance:f})||u)}}}},update:Hn(function(){return new Promise(function(p){f.forceUpdate(),p(u)})}),destroy:function(){g(),v=!0}};if(!Ct(c,o))return f;f.setOptions(d).then(function(p){!v&&d.onFirstUpdate&&d.onFirstUpdate(p)});function m(){u.orderedModifiers.forEach(function(p){var w=p.name,y=p.options,C=y===void 0?{}:y,b=p.effect;if(typeof b=="function"){var O=b({state:u,name:w,instance:f,options:C}),S=function(){};h.push(O||S)}})}function g(){h.forEach(function(p){return p()}),h=[]}return f}}const zn=Vn({defaultModifiers:[Pn,Mn,fn,mn,Tn,Rn,Fn,cn]}),Kn=["enabled","placement","strategy","modifiers"];function Yn(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}const Xn={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},Gn={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:({state:t})=>()=>{const{reference:e,popper:r}=t.elements;if("removeAttribute"in e){const n=(e.getAttribute("aria-describedby")||"").split(",").filter(i=>i.trim()!==r.id);n.length?e.setAttribute("aria-describedby",n.join(",")):e.removeAttribute("aria-describedby")}},fn:({state:t})=>{var e;const{popper:r,reference:n}=t.elements,i=(e=r.getAttribute("role"))==null?void 0:e.toLowerCase();if(r.id&&i==="tooltip"&&"setAttribute"in n){const a=n.getAttribute("aria-describedby");if(a&&a.split(",").indexOf(r.id)!==-1)return;n.setAttribute("aria-describedby",a?`${a},${r.id}`:r.id)}}},Qn=[];function Jn(t,e,r={}){let{enabled:n=!0,placement:i="bottom",strategy:a="absolute",modifiers:l=Qn}=r,c=Yn(r,Kn);const o=x.useRef(l),d=x.useRef(),u=x.useCallback(()=>{var p;(p=d.current)==null||p.update()},[]),h=x.useCallback(()=>{var p;(p=d.current)==null||p.forceUpdate()},[]),[v,f]=Hr(x.useState({placement:i,update:u,forceUpdate:h,attributes:{},styles:{popper:{},arrow:{}}})),m=x.useMemo(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:({state:p})=>{const w={},y={};Object.keys(p.elements).forEach(C=>{w[C]=p.styles[C],y[C]=p.attributes[C]}),f({state:p,styles:w,attributes:y,update:u,forceUpdate:h,placement:p.placement})}}),[u,h,f]),g=x.useMemo(()=>(fe(o.current,l)||(o.current=l),o.current),[l]);return x.useEffect(()=>{!d.current||!n||d.current.setOptions({placement:i,strategy:a,modifiers:[...g,m,Xn]})},[a,i,m,n,g]),x.useEffect(()=>{if(!(!n||t==null||e==null))return d.current=zn(t,e,Object.assign({},c,{placement:i,strategy:a,modifiers:[...g,Gn,m]})),()=>{d.current!=null&&(d.current.destroy(),d.current=void 0,f(p=>Object.assign({},p,{attributes:{},styles:{popper:{}}})))}},[n,t,e]),v}const St=()=>{};function Zn(t){return t.button===0}function ei(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}const Pe=t=>t&&("current"in t?t.current:t),Ot={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"};function ti(t,e=St,{disabled:r,clickTrigger:n="click"}={}){const i=x.useRef(!1),a=x.useRef(!1),l=x.useCallback(d=>{const u=Pe(t);Sr(!!u,"ClickOutside captured a close event but does not have a ref to compare it to. useClickOutside(), should be passed a ref that resolves to a DOM node"),i.current=!u||ei(d)||!Zn(d)||!!Fe(u,d.target)||a.current,a.current=!1},[t]),c=Le(d=>{const u=Pe(t);u&&Fe(u,d.target)?a.current=!0:a.current=!1}),o=Le(d=>{i.current||e(d)});x.useEffect(()=>{var d,u;if(r||t==null)return;const h=Pt(Pe(t)),v=h.defaultView||window;let f=(d=v.event)!=null?d:(u=v.parent)==null?void 0:u.event,m=null;Ot[n]&&(m=pe(h,Ot[n],c,!0));const g=pe(h,n,l,!0),p=pe(h,n,y=>{if(y===f){f=void 0;return}o(y)});let w=[];return"ontouchstart"in h.documentElement&&(w=[].slice.call(h.body.children).map(y=>pe(y,"mousemove",St))),()=>{m?.(),g(),p(),w.forEach(y=>y())}},[t,r,n,l,c,o])}function ri(t){const e={};return Array.isArray(t)?(t?.forEach(r=>{e[r.name]=r}),e):t||e}function ni(t={}){return Array.isArray(t)?t:Object.keys(t).map(e=>(t[e].name=e,t[e]))}function ii({enabled:t,enableEvents:e,placement:r,flip:n,offset:i,fixed:a,containerPadding:l,arrowElement:c,popperConfig:o={}}){var d,u,h,v,f;const m=ri(o.modifiers);return Object.assign({},o,{placement:r,enabled:t,strategy:a?"fixed":o.strategy,modifiers:ni(Object.assign({},m,{eventListeners:{enabled:e,options:(d=m.eventListeners)==null?void 0:d.options},preventOverflow:Object.assign({},m.preventOverflow,{options:l?Object.assign({padding:l},(u=m.preventOverflow)==null?void 0:u.options):(h=m.preventOverflow)==null?void 0:h.options}),offset:{options:Object.assign({offset:i},(v=m.offset)==null?void 0:v.options)},arrow:Object.assign({},m.arrow,{enabled:!!c,options:Object.assign({},(f=m.arrow)==null?void 0:f.options,{element:c})}),flip:Object.assign({enabled:!!n},m.flip)}))})}const si=()=>{};function ai(t,e,{disabled:r,clickTrigger:n}={}){const i=e||si;ti(t,i,{disabled:r,clickTrigger:n});const a=Le(l=>{Rr(l)&&i(l)});x.useEffect(()=>{if(r||t==null)return;const l=Pt(Pe(t));let c=(l.defaultView||window).event;const o=pe(l,"keyup",d=>{if(d===c){c=void 0;return}a(d)});return()=>{o()}},[t,r,a])}const Ut=x.forwardRef((t,e)=>{const{flip:r,offset:n,placement:i,containerPadding:a,popperConfig:l={},transition:c,runTransition:o}=t,[d,u]=pt(),[h,v]=pt(),f=yr(u,e),m=ot(t.container),g=ot(t.target),[p,w]=x.useState(!t.show),y=Jn(g,d,ii({placement:i,enableEvents:!!t.show,containerPadding:a||5,flip:r,offset:n,arrowElement:h,popperConfig:l}));t.show&&p&&w(!1);const C=(...D)=>{w(!0),t.onExited&&t.onExited(...D)},b=t.show||!p;if(ai(d,t.onHide,{disabled:!t.rootClose||t.rootCloseDisabled,clickTrigger:t.rootCloseEvent}),!b)return null;const{onExit:O,onExiting:S,onEnter:R,onEntering:E,onEntered:P}=t;let N=t.children(Object.assign({},y.attributes.popper,{style:y.styles.popper,ref:f}),{popper:y,placement:i,show:!!t.show,arrowProps:Object.assign({},y.attributes.arrow,{style:y.styles.arrow,ref:v})});return N=br(c,o,{in:!!t.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:N,onExit:O,onExiting:S,onExited:C,onEnter:R,onEntering:E,onEntered:P}),m?Dr.createPortal(N,m):null});Ut.displayName="Overlay";const Wt=x.forwardRef(({className:t,bsPrefix:e,as:r="div",...n},i)=>(e=ie(e,"popover-header"),s.jsx(r,{ref:i,className:xe(t,e),...n})));Wt.displayName="PopoverHeader";const Ge=x.forwardRef(({className:t,bsPrefix:e,as:r="div",...n},i)=>(e=ie(e,"popover-body"),s.jsx(r,{ref:i,className:xe(t,e),...n})));Ge.displayName="PopoverBody";function Ht(t,e){let r=t;return t==="left"?r=e?"end":"start":t==="right"&&(r=e?"start":"end"),r}function _t(t="absolute"){return{position:t,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}const Vt=x.forwardRef(({bsPrefix:t,placement:e="right",className:r,style:n,children:i,body:a,arrowProps:l,hasDoneInitialMeasure:c,popper:o,show:d,...u},h)=>{const v=ie(t,"popover"),f=Dt(),[m]=e?.split("-")||[],g=Ht(m,f);let p=n;return d&&!c&&(p={...n,..._t(o?.strategy)}),s.jsxs("div",{ref:h,role:"tooltip",style:p,"x-placement":m,className:xe(r,v,m&&`bs-popover-${g}`),...u,children:[s.jsx("div",{className:"popover-arrow",...l}),a?s.jsx(Ge,{children:i}):i]})});Vt.displayName="Popover";const oi=Object.assign(Vt,{Header:Wt,Body:Ge,POPPER_OFFSET:[0,8]}),zt=x.forwardRef(({bsPrefix:t,placement:e="right",className:r,style:n,children:i,arrowProps:a,hasDoneInitialMeasure:l,popper:c,show:o,...d},u)=>{t=ie(t,"tooltip");const h=Dt(),[v]=e?.split("-")||[],f=Ht(v,h);let m=n;return o&&!l&&(m={...n,..._t(c?.strategy)}),s.jsxs("div",{ref:u,style:m,role:"tooltip","x-placement":v,className:xe(r,t,`bs-tooltip-${f}`),...d,children:[s.jsx("div",{className:"tooltip-arrow",...a}),s.jsx("div",{className:`${t}-inner`,children:i})]})});zt.displayName="Tooltip";const Kt=Object.assign(zt,{TOOLTIP_OFFSET:[0,6]});function li(t){const e=x.useRef(null),r=ie(void 0,"popover"),n=ie(void 0,"tooltip"),i=x.useMemo(()=>({name:"offset",options:{offset:()=>{if(t)return t;if(e.current){if(lt(e.current,r))return oi.POPPER_OFFSET;if(lt(e.current,n))return Kt.TOOLTIP_OFFSET}return[0,0]}}}),[t,r,n]);return[e,[i]]}function ci(t,e){const{ref:r}=t,{ref:n}=e;t.ref=r.__wrapped||(r.__wrapped=i=>r($e(i))),e.ref=n.__wrapped||(n.__wrapped=i=>n($e(i)))}const Yt=x.forwardRef(({children:t,transition:e=ct,popperConfig:r={},rootClose:n=!1,placement:i="top",show:a=!1,...l},c)=>{const o=x.useRef({}),[d,u]=x.useState(null),[h,v]=li(l.offset),f=Et(c,h),m=e===!0?ct:e||void 0,g=Nr(p=>{u(p),r==null||r.onFirstUpdate==null||r.onFirstUpdate(p)});return jr(()=>{d&&l.target&&(o.current.scheduleUpdate==null||o.current.scheduleUpdate())},[d,l.target]),x.useEffect(()=>{a||u(null)},[a]),s.jsx(Ut,{...l,ref:f,popperConfig:{...r,modifiers:v.concat(r.modifiers||[]),onFirstUpdate:g},transition:m,rootClose:n,placement:i,show:a,children:(p,{arrowProps:w,popper:y,show:C})=>{var b;ci(p,w);const O=y?.placement,S=Object.assign(o.current,{state:y?.state,scheduleUpdate:y?.update,placement:O,outOfBoundaries:(y==null||(b=y.state)==null||(b=b.modifiersData.hide)==null?void 0:b.isReferenceHidden)||!1,strategy:r.strategy}),R=!!d;return typeof t=="function"?t({...p,placement:O,show:C,...!e&&C&&{className:"show"},popper:S,arrowProps:w,hasDoneInitialMeasure:R}):x.cloneElement(t,{...p,placement:O,arrowProps:w,popper:S,hasDoneInitialMeasure:R,className:xe(t.props.className,!e&&C&&"show"),style:{...t.props.style,...p.style}})}})});Yt.displayName="Overlay";function ui(t){return t&&typeof t=="object"?t:{show:t,hide:t}}function Rt(t,e,r){const[n]=e,i=n.currentTarget,a=n.relatedTarget||n.nativeEvent[r];(!a||a!==i)&&!Fe(i,a)&&t(...e)}Cr.oneOf(["click","hover","focus"]);const di=({trigger:t=["hover","focus"],overlay:e,children:r,popperConfig:n={},show:i,defaultShow:a=!1,onToggle:l,delay:c,placement:o,flip:d=o&&o.indexOf("auto")!==-1,...u})=>{const h=x.useRef(null),v=Et(h,Pr(r)),f=Wr(),m=x.useRef(""),[g,p]=Er(i,a,l),w=ui(c),{onFocus:y,onBlur:C,onClick:b}=typeof r!="function"?x.Children.only(r).props:{},O=M=>{v($e(M))},S=x.useCallback(()=>{if(f.clear(),m.current="show",!w.show){p(!0);return}f.set(()=>{m.current==="show"&&p(!0)},w.show)},[w.show,p,f]),R=x.useCallback(()=>{if(f.clear(),m.current="hide",!w.hide){p(!1);return}f.set(()=>{m.current==="hide"&&p(!1)},w.hide)},[w.hide,p,f]),E=x.useCallback((...M)=>{S(),y?.(...M)},[S,y]),P=x.useCallback((...M)=>{R(),C?.(...M)},[R,C]),N=x.useCallback((...M)=>{p(!g),b?.(...M)},[b,p,g]),D=x.useCallback((...M)=>{Rt(S,M,"fromElement")},[S]),B=x.useCallback((...M)=>{Rt(R,M,"toElement")},[R]),A=t==null?[]:[].concat(t),F={ref:O};return A.indexOf("click")!==-1&&(F.onClick=N),A.indexOf("focus")!==-1&&(F.onFocus=E,F.onBlur=P),A.indexOf("hover")!==-1&&(F.onMouseOver=D,F.onMouseOut=B),s.jsxs(s.Fragment,{children:[typeof r=="function"?r(F):x.cloneElement(r,F),s.jsx(Yt,{...u,show:g,onHide:R,flip:d,placement:o,popperConfig:n,target:h.current,children:e})]})};function pi({recipe:t,images:e}){let r={"@context":"https://schema.org/","@type":"Recipe",name:t.name,author:{"@type":"Person",name:t.owner?.userName},image:e.map(n=>n.url),recipeYield:t.servingsProduced,cookTime:`${ir.duration(t.cooktimeMinutes,"minutes").toISOString()}`,recipeIngredient:t.recipeComponents.flatMap(n=>n.ingredients?.map(i=>`${i.quantity} ${i.unit} ${i.ingredient.name}`)),recipeInstructions:t.recipeComponents.flatMap(n=>n.steps?.map(i=>({"@type":"HowToStep",text:i})))};return t.reviewCount>0&&(r.aggregateRating={"@type":"AggregateRating",ratingValue:t.averageReviews,ratingCount:t.reviewCount,bestRating:5,worstRating:1}),s.jsx("script",{type:"application/ld+json",children:JSON.stringify(r)})}function fi(t,e,r){return{before:t.substring(0,e),inside:t.substring(e,e+r),after:t.substring(e+r,t.length)}}function Nt({recipe:t,stepText:e,multipart:r,component:n,newServings:i}){let a=[{ingredient:null,text:e}];const c=[...r?n.ingredients:t.ingredients??[]].sort((o,d)=>{const u=o.text??o.ingredient.name.length,h=d.text??d.ingredient.name.length;return typeof u=="string"&&typeof h=="string"?h.length-u.length:d.ingredient.name.length-o.ingredient.name.length});for(const o of c){const d=o.ingredient.name.split(";").map(v=>`(${v.trim()})`).join("|"),u=new RegExp(`${d}`,"i");let h=0;for(;h<a.length;){const v=a[h],f=v.text.match(u);if(f!=null){const{before:m,inside:g,after:p}=fi(v.text,f.index,f[0].length);f.index===0?a.splice(h,1,{text:g,ingredient:o},{text:p,ingredient:null}):(a.splice(h,1,{text:m,ingredient:null},{text:g,ingredient:o},{text:p,ingredient:null}),h++)}h++}}return s.jsx("div",{children:a.map((o,d)=>{if(o.ingredient==null)return s.jsx("span",{children:o.text},d);const h=`${o.ingredient.quantity*i/t.servingsProduced} ${o.ingredient.unit}`;return s.jsx(di,{overlay:s.jsx(Kt,{id:`tooltip-${d}`,children:h}),children:s.jsx("a",{className:"tooltip-style",href:"#",children:o.text})},d)})})}function hi({id:t,index:e,stepText:r,onTextChange:n,onDelete:i}){const{attributes:a,listeners:l,setNodeRef:c,transform:o,transition:d}=hr({id:t}),u={transform:mr.Transform.toString(o),transition:d};return s.jsx("div",{ref:c,style:u,children:s.jsxs(T,{children:[s.jsxs(j,{className:"col d-flex align-items-center get-smaller",children:[s.jsx("i",{className:"margin-right-10 drag-handle bi bi-grip-vertical",style:{cursor:"grab"},...a,...l}),s.jsx(Or,{as:"textarea",rows:4,className:"margin-bottom-8",type:"text",placeholder:"Recipe step",value:r,onChange:h=>n(e,h.target.value)})]}),s.jsx(j,{xs:1,children:s.jsx(I,{className:"float-end",variant:"danger",children:s.jsx("i",{onClick:()=>i(e),className:"bi bi-trash"})})})]})})}function mi(t){const{recipe:e,multipart:r,component:n,newServings:i,edit:a,onChange:l,onDeleteStep:c,onNewStep:o}=t,d=sr(at(fr),at(pr,{coordinateGetter:dr})),u=r?n?.steps??[]:e.steps??[],h=u.map((g,p)=>`step-${p}`);function v(g){const{active:p,over:w}=g;if(w&&p.id!==w.id){const y=h.indexOf(p.id),C=h.indexOf(w.id),b=ur([...u],y,C);l(b)}}function f(g,p){const w=[...u];w[g]=p,l(w)}function m(g){c(g,n)}return a?s.jsxs(k,{children:[s.jsx(ar,{sensors:d,collisionDetection:or,onDragEnd:v,children:s.jsx(lr,{items:h,strategy:cr,children:u.map((g,p)=>s.jsx(hi,{id:h[p],index:p,stepText:g,onTextChange:f,onDelete:m},h[p]))})}),s.jsx(j,{xs:12,children:s.jsx(I,{variant:"outline-primary",className:"width-100 margin-bottom-10",onClick:()=>o(),children:"New step"})})]}):r?s.jsx(s.Fragment,{children:n?.steps?.map((g,p)=>s.jsxs(T,{children:[s.jsx(j,{className:"step-number",children:p+1}),s.jsx(j,{className:"margin-bottom-12",children:s.jsx(Nt,{multipart:r,recipe:e,stepText:g,component:n,newServings:i})})]},p))}):s.jsx(s.Fragment,{children:e.steps?.map((g,p)=>s.jsxs(T,{children:[s.jsx(j,{className:"step-number",children:p+1}),s.jsx(j,{className:"margin-bottom-12",children:s.jsx(Nt,{multipart:r,recipe:e,stepText:g,newServings:i})})]},p))})}function gi({recipe:t}){const[e,r]=x.useState(0),[n,i]=x.useState(""),[a,l]=x.useState(!1);function c(o){const d=o.currentTarget;if(o.preventDefault(),o.stopPropagation(),d.checkValidity()===!1||e===0){l(!0);return}fetch(`/api/MultiPartRecipe/${t.id}/review`,{method:"PUT",body:JSON.stringify({rating:e,text:n,validated:a}),headers:{"Content-Type":"application/json"}}).then(u=>{u.ok&&location.reload()})}return s.jsxs(k,{noValidate:!0,validated:a,onSubmit:o=>c(o),className:"margin-top-20",children:[s.jsxs(k.Group,{children:[s.jsx(We,{style:{maxWidth:200},value:e,onChange:r}),s.jsx(k.Control.Feedback,{type:"invalid",children:"Please provide a rating."})]}),s.jsxs(k.Group,{children:[s.jsx(k.Control,{required:!0,as:"textarea",rows:4,className:"margin-bottom-8 margin-top-8",type:"text",placeholder:"Rate and write a review for this recipe",value:n,onChange:o=>{i(o.target.value)}}),s.jsx(k.Control.Feedback,{type:"invalid",children:"Please provide both a review and a rating."})]}),s.jsx(I,{className:"margin-bottom-20",variant:"outline-primary",type:"submit",children:"Submit"})]})}function vi({recipeId:t}){const[e,r]=x.useState([]),{user:n}=Mr();x.useEffect(()=>{async function a(){r(await Tr(t))}a()},[t]);function i(){fetch(`/api/MultiPartRecipe/${t}/review`,{method:"DELETE",headers:{"Content-Type":"application/json"}}).then(a=>{a.ok&&r(e.filter(l=>l.owner.id!==n?.id))})}return s.jsx("div",{children:e?.map((a,l)=>s.jsxs(Ie,{className:"review-card",children:[s.jsxs(T,{children:[s.jsx(j,{children:s.jsxs(Ie.Link,{className:"",children:[s.jsx(We,{style:{maxWidth:100},value:a.rating,readOnly:!0}),s.jsx("span",{className:"margin-left-10",children:a.owner.userName})]})}),s.jsx(j,{children:a.owner.id===n?.id?s.jsx(I,{className:"float-end",variant:"danger",onClick:c=>i(),children:"Delete"}):null})]}),s.jsx(Ie.Body,{children:a.text})]},l))})}class xi extends x.Component{render(){let e=this.props.data.map((r,n)=>s.jsxs("span",{className:"badge",children:[s.jsx("input",{type:"hidden",name:`Skills[${n}]`,value:r}),r,s.jsx("i",{className:"bi bi-x margin-left-4",onClick:i=>this.props.onDelete(n)})]},n));return s.jsx("div",{children:e})}}const wi=t=>t.name,yi=t=>s.jsx("div",{children:t.name});class bi extends x.Component{fetchRequestCount;constructor(e){super(e),this.state={value:"",suggestions:[],tags:this.props.initialTags},this.fetchRequestCount=0}onChange=(e,{newValue:r,method:n})=>{if(n==="enter"){let i={name:this.state.value,id:ne(),isNew:!1},a=[...this.state.tags,i];this.setState({tags:a,value:""}),this.props.tagsChanged(a)}else this.setState({value:r})};onSuggestionSelected=(e,{suggestion:r,suggestionValue:n})=>{console.log(n);let i={name:n,id:ne(),isNew:!0},a=[...this.state.tags,i];this.setState({tags:a,value:""}),this.props.tagsChanged(a)};onSuggestionsFetchRequested=({value:e})=>{if(this.fetchRequestCount=(this.fetchRequestCount+1)%2,this.fetchRequestCount===0){let r=this.props.queryBuilder(e);fetch(r).then(n=>n.json()).then(n=>{console.log(n);let a=n.filter((l,c)=>!this.state.tags.map(o=>o.name).includes(l.name));this.setState({suggestions:a})})}};onSuggestionsClearRequested=()=>{this.setState({suggestions:[]})};onDelete=e=>{let r=this.state.tags.filter((n,i)=>i!==e);return this.setState({tags:r}),this.props.tagsChanged(r),!0};onKeyDown=e=>{switch(e.keyCode){case 13:{e.preventDefault();let{value:r,tags:n}=this.state,i=r.trim()==="";if(!(n.findIndex(l=>r.toUpperCase()===l.name.toUpperCase())!==-1)&&!i){let l={name:r,id:ne(),isNew:!0},c=[...n,l];this.setState({tags:c,value:""}),console.log(l),this.props.tagsChanged(c)}}}};render(){const{value:e,suggestions:r,tags:n}=this.state,i={placeholder:"Categories",value:e,onChange:this.onChange,onKeyDown:this.onKeyDown,className:"form-control width-100"};return s.jsxs("div",{className:"width-100",children:[s.jsx(xi,{data:n.map(a=>a.name),onDelete:this.onDelete}),s.jsx(gr,{suggestions:r,onSuggestionsFetchRequested:this.onSuggestionsFetchRequested,onSuggestionsClearRequested:this.onSuggestionsClearRequested,getSuggestionValue:wi,renderSuggestion:yi,inputProps:i,onSuggestionSelected:this.onSuggestionSelected})]})}}function ji({user:t,recipe:e,edit:r,operationInProgress:n,onSave:i,onCancel:a,onDelete:l,onToggleEdit:c,onAddtoCard:o}){let d=t!==null,u=d&&t.id===e.owner?.id||t?.roles.includes("Administrator");const h=s.jsx(j,{children:s.jsxs(T,{children:[s.jsx(j,{children:s.jsx(I,{className:"recipe-edit-buttons font-weight-600",onClick:f=>i(),children:n?s.jsx(Ir,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):"Save"})}),s.jsx(j,{children:s.jsx(I,{className:"recipe-edit-buttons margin-bottom-15",onClick:f=>a(),children:"Cancel"})}),s.jsx(j,{children:s.jsx(I,{variant:"danger",className:"recipe-edit-buttons margin-bottom-15",onClick:f=>l(),children:"Delete"})}),t?.roles.includes("Administrator")&&s.jsx(j,{children:s.jsx(I,{className:"recipe-edit-buttons margin-bottom-15",onClick:f=>{Ar(e.id).then(m=>{alert("Image generated")})},children:"Generate Image"})})]})});return r?h:s.jsx(j,{children:s.jsxs(T,{children:[s.jsx(j,{children:!d||!u?s.jsx("div",{"data-bs-toggle":"tooltip","data-bs-placement":"bottom",title:"Sign in to modify your own recipes",children:s.jsx(I,{className:"recipe-edit-buttons",disabled:!d||!u,onClick:f=>c(),children:"Edit"})}):s.jsx(I,{className:"recipe-edit-buttons",disabled:!d||!u,onClick:f=>c(),children:"Edit"})}),s.jsx(j,{children:d?s.jsx(I,{className:"recipe-edit-buttons",disabled:!d,onClick:f=>o(),children:"Add to Groceries"}):s.jsx("div",{"data-bs-toggle":"tooltip","data-bs-placement":"bottom",title:"Sign in to add recipes to your cart",children:s.jsx(I,{className:"recipe-edit-buttons",disabled:!d,onClick:f=>o(),children:"Add to Groceries"})})})]})})}class Ci extends x.Component{constructor(e){super(e),this.state={error:!1,edit:!1,units:[],newImage:void 0,newImageSrc:void 0,nutritionFacts:void 0,recipeImages:[],recipe:{id:"",name:"",source:"",cooktimeMinutes:5,caloriesPerServing:100,servingsProduced:2,categories:[],staticImage:"",owner:null,recipeComponents:[],reviewCount:0,averageReviews:4},newServings:1,operationInProgress:!1}}componentDidMount(){fetch("/api/recipe/units").then(e=>e.json()).then(e=>{this.setState({units:e})}),this.props.multipart?(fetch(`/api/multipartrecipe/${this.props.recipeId}`).then(e=>e.json()).then(e=>{let r=e;document.title=r.name+" - CookTime",r.recipeComponents.sort((n,i)=>n.position-i.position),this.setServingsFromQueryParameters(r);for(let n=0;n<r.recipeComponents.length;n++)r.recipeComponents[n].ingredients?.sort((a,l)=>a.position-l.position);this.setState({recipe:r})}),fetch(`/api/MultiPartRecipe/${this.props.recipeId}/images`).then(e=>e.json()).then(e=>{let r=e;this.setState({recipeImages:r})}),this.getNutritionData()):(fetch(`/api/recipe/${this.props.recipeId}`).then(e=>e.json()).then(e=>{let r=e;this.setServingsFromQueryParameters(r),this.setState({recipe:r})}),fetch(`/api/recipe/${this.props.recipeId}/images`).then(e=>e.json()).then(e=>{let r=e;this.setState({recipeImages:r})}))}getNutritionData(){fetch(`/api/MultiPartRecipe/${this.props.recipeId}/nutritionData`).then(e=>e.json()).then(e=>{let r=e;this.setState({nutritionFacts:r})})}setServingsFromQueryParameters(e){const n=new URLSearchParams(window.location.search).get("servings");let i=e.servingsProduced;n!=null&&(i=parseInt(n)),this.setState({newServings:i})}appendNewIngredientRequirementRowForComponent(e,r){if(this.props.multipart){var n={ingredient:{name:"",id:ne(),isNew:!1,densityKgPerL:1},unit:"Count",quantity:0,id:ne(),text:"",position:r.ingredients?.length??0},i=Array.from(r.ingredients??[]);i.push(n),r.ingredients=i;let a=Array.from(this.state.recipe.recipeComponents);this.setState({...this.state,recipe:{...this.state.recipe,recipeComponents:a}})}}deleteIngredientRequirementForComponent(e,r,n){if(this.props.multipart){var i=r.ingredients?.filter(l=>l.id!==n.id).map((l,c)=>(l.position=c,l));r.ingredients=i;let a=Array.from(this.state.recipe.recipeComponents);a[e]=r,this.setState({recipe:{...this.state.recipe,recipeComponents:a}})}}updateIngredientRequirementForComponent(e,r,n,i){if(this.props.multipart){const a=r.ingredients.findIndex(d=>d.ingredient.id===n.ingredient.id),l=i(r.ingredients[a]);let c=Array.from(r.ingredients);c[a]=l;let o=Array.from(this.state.recipe.recipeComponents);this.setState({...this.state,recipe:{...this.state.recipe,recipeComponents:o}})}}appendNewStepForComponent(e,r){if(this.props.multipart){var n=Array.from(r.steps??[]);n.push(""),r.steps=n;let i=Array.from(this.state.recipe.recipeComponents);this.setState({recipe:{...this.state.recipe,recipeComponents:i}})}}changeOrReorder(e,r,n){if(this.props.multipart){r.steps=n;let i=Array.from(this.state.recipe.recipeComponents);this.setState({recipe:{...this.state.recipe,recipeComponents:i}})}}deleteStep(e,r){if(this.props.multipart){let n=this.state.recipe,i=Array.from(n.recipeComponents),a=i.findIndex(c=>c.id===r.id),l=r?.steps?.filter((c,o)=>o!==e);i[a].steps=l,this.setState({recipe:{...n,recipeComponents:i}})}}render(){return s.jsxs("div",{children:[s.jsx(pi,{recipe:this.state.recipe,images:this.state.recipeImages}),s.jsx(T,{children:s.jsxs(s.Fragment,{children:[s.jsxs(j,{className:"justify-content-md-left",xs:6,children:[this.state.edit?s.jsx("div",{className:"recipe-name-input",children:s.jsx(k.Control,{type:"text",onChange:e=>this.setState({recipe:{...this.state.recipe,name:e.target.value}}),value:this.state.recipe.name})}):s.jsx("h1",{children:this.state.recipe.name}),this.state.recipe.reviewCount>0?s.jsxs(Fr,{direction:"horizontal",className:"margin-bottom-8",children:[s.jsx(We,{style:{maxWidth:150},value:this.state.recipe.averageReviews,readOnly:!0})," ","(",this.state.recipe.reviewCount,")"]}):null,"By ",this.state.recipe.owner?.userName]}),s.jsx(ut.Consumer,{children:({user:e})=>s.jsx(ji,{user:e,recipe:this.state.recipe,edit:this.state.edit,operationInProgress:this.state.operationInProgress,onSave:()=>this.onSave(),onCancel:()=>this.onCancel(),onDelete:()=>this.onDelete(),onToggleEdit:()=>this.setState({edit:!this.state.edit}),onAddtoCard:()=>this.onAddtoCard()})})]})}),this.state.error?s.jsxs(dt,{variant:"danger",onClose:()=>this.setState({error:!1}),dismissible:!0,children:[s.jsx(dt.Heading,{children:"Could not save recipe."}),s.jsx("p",{})]}):null,this.image(),this.todaysTen(),s.jsxs("div",{children:[this.caloriesPerServingComponent(),s.jsxs(T,{className:"padding-right-0 d-flex align-items-center recipe-edit-row",children:[s.jsx(j,{className:"col-3 recipe-field-title",children:"Servings"}),s.jsx(j,{className:"col d-flex align-items-center",children:this.state.edit?s.jsx(k.Control,{type:"number",min:"1",onChange:e=>this.setState({recipe:{...this.state.recipe,servingsProduced:parseInt(e.target.value)}}),value:this.state.recipe.servingsProduced}):s.jsxs("div",{className:"serving-counter",children:[s.jsx(I,{variant:"danger",className:"minus-counter-button",onClick:e=>{this.state.newServings>0&&this.setState({newServings:this.state.newServings-1})},children:s.jsx("i",{className:"bi bi-dash"})}),s.jsx(k.Control,{onChange:e=>{e.target.value===""&&this.setState({newServings:0});let r=parseFloat(e.target.value);!Number.isNaN(r)&&r>0&&this.setState({newServings:r})},className:"form-control count",value:this.state.newServings}),s.jsx(I,{variant:"success",className:"plus-counter-button",onClick:e=>this.setState({newServings:this.state.newServings+1}),children:s.jsx("i",{className:"bi bi-plus"})})]})})]}),!this.state.edit&&this.state.recipe.categories.length===0?null:s.jsxs(T,{className:"padding-right-0 d-flex align-items-center recipe-edit-row",children:[s.jsx(j,{className:"col-3 recipe-field-title",children:"Categories"}),s.jsx(j,{className:"col d-flex align-items-center",children:this.tagsComponent()})]}),!this.state.edit&&(this.state.recipe.cooktimeMinutes==0||this.state.recipe.cooktimeMinutes==null)?null:s.jsxs(T,{className:"padding-right-0 d-flex align-items-center recipe-edit-row",children:[s.jsx(j,{className:"col-3 recipe-field-title",children:"Cook Time (Minutes)"}),s.jsx(j,{className:"col d-flex align-items-center",children:this.state.edit?s.jsx(k.Control,{type:"number",onChange:e=>this.setState({...this.state,recipe:{...this.state.recipe,cooktimeMinutes:parseInt(e.target.value)}}),value:this.state.recipe.cooktimeMinutes}):s.jsx("div",{children:this.state.recipe.cooktimeMinutes})})]}),(this.state.recipe.source==""||this.state.recipe.source==null)&&!this.state.edit?null:s.jsxs(T,{className:"padding-right-0 d-flex align-items-center recipe-edit-row",children:[s.jsx(j,{className:"col-3 recipe-field-title",children:"Link to Original Recipe"}),s.jsx(j,{className:"col d-flex align-items-center",children:this.state.edit?s.jsx(k.Control,{type:"text",onChange:e=>this.setState({recipe:{...this.state.recipe,source:e.target.value}}),value:this.state.recipe.source}):s.jsx("a",{href:this.state.recipe.source,children:this.state.recipe.source})})]}),this.state.edit?s.jsxs(T,{className:"padding-right-0 d-flex align-items-center recipe-edit-row",children:[s.jsx(j,{className:"col-3 recipe-field-title",children:"Image"}),s.jsx(j,{className:"col d-flex align-items-center",children:s.jsx(k.Group,{controlId:"formFile",className:"image-selector",children:s.jsx(k.Control,{type:"file",accept:".jpg,.jpeg,.png",multiple:!1,onChange:e=>{let r=e.target.files;if(r.length!=1)return;let n=new FileReader;n.readAsDataURL(r.item(0)),n.onload=i=>{this.setState({newImage:r.item(0),newImageSrc:n.result})}}})})})]}):null,this.RecipeOrComponents()]}),this.state.edit?null:s.jsx("div",{className:"border-top-1 margin-top-10",children:s.jsxs(T,{children:[s.jsx(j,{xs:3,className:"nft-row",children:this.nutritionFacts()}),s.jsx(j,{children:this.ingredientNutritionFacts()})]})}),s.jsx(ut.Consumer,{children:({user:e})=>e&&!this.state.edit&&s.jsx("div",{className:"border-top-1 margin-top-30",children:s.jsx(T,{children:s.jsx(j,{children:s.jsx(gi,{recipe:this.state.recipe})})})})}),this.state.edit?null:s.jsx("div",{className:"margin-top-10",children:s.jsx(T,{children:s.jsx(j,{children:s.jsx(vi,{recipeId:this.props.recipeId})})})})]})}todaysTen(){let e=this.state.nutritionFacts?.dietDetails.find(r=>r.name==="TodaysTen");return!this.state.edit&&e!=null?s.jsx(kr,{todaysTen:e}):null}tagsComponent(){if(this.state.edit)return s.jsx(bi,{queryBuilder:e=>`/api/recipe/tags?query=${e}`,initialTags:this.state.recipe.categories,tagsChanged:e=>{this.setState({...this.state,recipe:{...this.state.recipe,categories:e}})}});{let e=this.state.recipe.categories.map(r=>this.toTitleCase(r.name)).join(", ");return s.jsx("div",{className:"tag-style",children:e})}}toTitleCase(e){return e.replace(/\w\S*/g,function(r){return r.charAt(0).toUpperCase()+r.substr(1).toLowerCase()})}ingredientNutritionFacts(){if((this.state.nutritionFacts?.recipe??null)!==null){var e=this.state.nutritionFacts?.ingredients.map((r,n)=>s.jsxs("div",{className:"nbi-table-entry",children:[s.jsxs("div",{children:[r.quantity," ",r.unit=="count"?"":r.unit.toLowerCase()," ",r.name]}),s.jsxs("div",{className:"nbi-table-source",children:[r.quantity," ",r.unit=="count"?"":r.unit.toLowerCase()," ",r.nutritionDatabaseId!==null?s.jsx("a",{target:"_blank",href:`https://fdc.nal.usda.gov/fdc-app.html#/food-details/${r.nutritionDatabaseId}/nutrients`,children:r.nutritionDatabaseDescriptor}):r.nutritionDatabaseDescriptor," | ",Math.round(r.caloriesPerServing)," calories per serving"]})]},n));return s.jsxs("div",{className:"nbi-table",children:[s.jsx("h1",{className:"performance-facts__title padding-8",children:"Nutrition by Ingredient"}),s.jsx("div",{children:e})]})}else return null}nutritionFacts(){if((this.state.nutritionFacts?.recipe??null)!==null){let{calories:e,carbohydrates:r,proteins:n,polyUnsaturatedFats:i,monoUnsaturatedFats:a,saturatedFats:l,sugars:c,transFats:o,iron:d,vitaminD:u,calcium:h,potassium:v}=this.state.nutritionFacts.recipe;return s.jsx(s.Fragment,{children:s.jsx(vr,{calories:Math.round(e/this.state.recipe.servingsProduced),saturatedFats:Math.round(l/this.state.recipe.servingsProduced),monoUnsaturatedFats:Math.round(a/this.state.recipe.servingsProduced),polyUnsaturatedFats:Math.round(i/this.state.recipe.servingsProduced),transFats:Math.round(o/this.state.recipe.servingsProduced),carbohydrates:Math.round(r/this.state.recipe.servingsProduced),sugars:Math.round(c/this.state.recipe.servingsProduced),proteins:Math.round(n/this.state.recipe.servingsProduced),servings:this.state.newServings,potassium:Math.round(v/this.state.recipe.servingsProduced),vitaminD:Math.round(u/this.state.recipe.servingsProduced),calcium:Math.round(h/this.state.recipe.servingsProduced),iron:Math.round(d/this.state.recipe.servingsProduced)})})}else return null}caloriesPerServingComponent(){var e=null;if(!this.state.edit&&this.state.recipe.caloriesPerServing===0&&(this.state.nutritionFacts?.recipe?.calories??0)===0)return null;if(!this.state.edit&&this.state.recipe.caloriesPerServing===0&&(this.state.nutritionFacts?.recipe?.calories??0)!==0){let{saturatedFats:r,monoUnsaturatedFats:n,polyUnsaturatedFats:i}=this.state.nutritionFacts.recipe;e=s.jsxs("div",{children:[Math.round(this.state.nutritionFacts.recipe.calories/this.state.recipe.servingsProduced)," kcal ",s.jsx("i",{className:"bi bi-calculator"})]})}else!this.state.edit&&this.state.recipe.caloriesPerServing!==0?e=s.jsx("div",{children:this.state.recipe.caloriesPerServing}):this.state.edit&&(e=s.jsx(k.Control,{type:"number",min:"0",onChange:r=>this.setState({recipe:{...this.state.recipe,caloriesPerServing:parseInt(r.target.value)}}),value:this.state.recipe.caloriesPerServing}));return s.jsxs(T,{className:"padding-right-0 d-flex align-items-center recipe-edit-row",children:[s.jsx(j,{className:"col-3 recipe-field-title",children:"Calories per Serving"}),s.jsx(j,{className:"col d-flex align-items-center",children:e})]})}RecipeOrComponents(){if(this.props.multipart){let e=this.state.recipe.recipeComponents?.map((r,n)=>this.EditBlockComponent(n,this.state.recipe,r));return s.jsxs("div",{children:[e,this.state.edit?s.jsx(k,{children:s.jsx(j,{xs:12,children:s.jsx(I,{variant:"outline-primary",className:"width-100",onClick:r=>this.appendNewComponent(),children:"New component"})})}):null]})}else return null}appendNewComponent(){let e=Array.from(this.state.recipe.recipeComponents);e.push({id:ne(),name:"",ingredients:[],steps:[],position:e.length}),this.setState({recipe:{...this.state.recipe,recipeComponents:e}})}deleteComponent(e,r){let n=Array.from(e.recipeComponents.filter((i,a)=>a!==r));this.setState({recipe:{...this.state.recipe,recipeComponents:n}})}EditBlockComponent(e,r,n){return s.jsxs("div",{className:"border-top-1 margin-bottom-20",children:[r.recipeComponents.length>1?s.jsxs(T,{className:"padding-right-0 d-flex align-items-center recipe-edit-row",children:[s.jsx(j,{className:"col-3 recipe-field-title",children:"Component Name"}),s.jsx(j,{children:s.jsxs(T,{children:[s.jsx(j,{className:"col d-flex align-items-center",children:this.state.edit?s.jsx(k.Control,{type:"text",onChange:i=>{let a=Array.from(r.recipeComponents);a[e].name=i.target.value,this.setState({recipe:{...r,recipeComponents:a}})},value:n.name}):s.jsx("div",{className:"component-name-field",children:n.name})}),this.state.edit?s.jsx(j,{xs:1,children:s.jsx(I,{className:"float-end",variant:"danger",onClick:i=>this.deleteComponent(r,e),children:s.jsx("i",{className:"bi bi-trash"})})}):null]})})]}):null,s.jsxs(T,{className:"padding-right-0 recipe-edit-row",children:[s.jsx(j,{className:"col-3 recipe-field-title",children:"Ingredients"}),s.jsx(j,{className:"col d-flex align-items-center",children:s.jsx("div",{className:"ingredient-list",children:s.jsx(xr,{ingredientRequirements:n.ingredients??[],onDelete:i=>this.deleteIngredientRequirementForComponent(e,n,i),onNewIngredientRequirement:()=>this.appendNewIngredientRequirementRowForComponent(e,n),updateIngredientRequirement:(i,a)=>this.updateIngredientRequirementForComponent(e,n,i,a),units:this.state.units,edit:this.state.edit,multiplier:this.state.newServings/this.state.recipe.servingsProduced})})})]}),s.jsxs(T,{className:"padding-right-0",children:[s.jsx(j,{className:"col-3 recipe-field-title",children:"Steps"}),s.jsx(j,{className:"col d-flex align-items-center",children:s.jsx("div",{className:"step-list",children:s.jsx(mi,{multipart:this.props.multipart,recipe:r,component:n,newServings:this.state.newServings,edit:this.state.edit,onDeleteStep:i=>this.deleteStep(i,n),onChange:i=>{console.log(i),this.changeOrReorder(e,n,i)},onNewStep:()=>this.appendNewStepForComponent(e,n)})})})]})]})}image(){return this.state.newImageSrc!=null&&this.state.newImageSrc!=""?s.jsx("img",{className:"recipe-image",src:this.state.newImageSrc}):this.state.recipeImages.length>0&&this.state.recipeImages[0].url?s.jsx("img",{className:"recipe-image",src:this.state.recipeImages[0].url}):this.state.recipe.staticImage===null?s.jsx("img",{className:"recipe-image",src:"/placeholder.jpg"}):s.jsx("img",{className:"recipe-image",src:`/${this.state.recipe.staticImage}`})}onMigrate(){fetch(`/api/Recipe/${this.props.recipeId}/migrate`,{method:"POST"}).then(e=>{e.redirected&&(window.location.href=e.url)})}onAddtoCard(){fetch(`/api/Cart?recipeId=${this.props.recipeId}`,{method:"POST"}).then(e=>{e.redirected&&(window.location.href=e.url)})}onCancel(){location.reload()}onDelete(){this.props.multipart?fetch(`/api/MultiPartRecipe/${this.props.recipeId}`,{method:"DELETE"}).then(e=>{e.ok?window.location.href="/":console.log(e.json())}):fetch(`/api/Recipe/${this.props.recipeId}`,{method:"DELETE"}).then(e=>{e.ok?window.location.href="/":console.log(e.json())})}onSave(){this.setState({operationInProgress:!0}),this.props.multipart&&this.saveMultiPartRecipe()}saveMultiPartRecipe(){var e=this.state.recipe;for(let n=0;n<e.recipeComponents.length;n++){const i=e.recipeComponents[n];i.steps=Array.from(i.steps??[]).filter(a=>a!=null&&a.trim()!==""),i.ingredients=Array.from(i.ingredients??[]).filter(a=>a.ingredient.name!=null&&a.ingredient.name!="")}(e.caloriesPerServing===null||isNaN(e.caloriesPerServing))&&(e.caloriesPerServing=0),(e.servingsProduced===null||isNaN(e.servingsProduced))&&(e.servingsProduced=1);const r=Lr(e);fetch(`/api/MultiPartRecipe/${this.props.recipeId}`,{method:"PUT",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}}).then(n=>{if(n.ok)if(this.state.newImage!=null){let i=new FormData;i.append("files",this.state.newImage),fetch(`/api/MultiPartRecipe/${this.props.recipeId}/image`,{method:"PUT",body:i}).then(a=>{location.reload()})}else location.reload();else this.setState({error:!0,operationInProgress:!1})})}}const Xt="Recipes/Details";function Hi(t){return`/${Xt}?id=${t}`}const _i=rr(function(){const[e]=nr(),r=typeof window<"u"?window.location.origin:"",n=e.get("id");return n?s.jsxs(s.Fragment,{children:[s.jsx($r,{children:s.jsx("link",{rel:"canonical",href:`${r}/${Xt}?id=${n}`})}),s.jsx(Ci,{recipeId:n,multipart:!0})]}):s.jsx(s.Fragment,{children:"No"})});export{Hi as P,_i as R,Jn as a,ti as b,ii as m,pt as u};
